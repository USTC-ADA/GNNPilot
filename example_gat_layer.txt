f: v_data(fd)
fo: v_data(fd)
we: data(fd, 2)
lr: data(1, 1)
e:  v_data(2)
em: v_data(1)
es: v_data(1)
h:  e_data(1)
ho: e_data(1)
#e = linear(f, we)#
h(nnz, 0) = scatter("e(i, 0) + e(j, 1)")
em(i, 0) = gather(MAX, "max(h(nnz, 0) * lr(0, 0), h(nnz, 0))")
ho(nnz, 0) = scatter("exp(h(nnz, 0) - em(i, 0))")
es(i, 0) = gather(SUM, "ho(nnz, 0)")
fo(i, :) = gather(SUM, "ho(nnz, 0) * f(j, :) / es(i, 0)")
